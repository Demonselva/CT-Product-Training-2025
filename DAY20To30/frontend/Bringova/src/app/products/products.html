<div class="container py-4">
  <h2 class="text-center text-primary fw-bold mb-4">Available Products</h2>

  <div class="row g-4">
    @for (product of products; track $index) {
      <div class="col-md-4 col-sm-6">
         @if(product?.stock=="Available"){
             
        <div class="card border-0 shadow-sm rounded-4 product-card h-100">
          <!-- <img
            [src]="product.image"
            class="card-img-top rounded-top-4"
            alt="{{ product.product_name }}"
          /> -->
          <div class="card-body text-center">
            <h5 class="fw-bold">{{ product.product_name }}</h5>

            @if (product.offer_price) {
              <p>
                <span class="text-muted text-decoration-line-through me-2">
                  â‚¹{{ product.price }}
                </span>
                <span class="text-success fw-bold">â‚¹{{ product.offer_price }}</span>
              </p>
            } @else {
              <p class="text-dark fw-bold">â‚¹{{ product.price }}</p>
            }

            <div class="d-flex justify-content-center gap-2 mt-2">
              <button
                class="btn btn-outline-info btn-sm rounded-pill"
                (click)="openDetails(product)"
              >
                <i class="fa fa-info-circle me-1"></i> Details
              </button>

              <button
                class="btn btn-primary btn-sm rounded-pill"
                (click)="openOrderForm(product)"
              >
                <i class="fa fa-shopping-cart me-1"></i> Buy Now
              </button>
            </div>
          </div>
        </div>
    }   @else{
                 <div class="card border-2 shadow-sm rounded-4 product-card h-100 card-no">
          <!-- <img
            [src]="product.image"
            class="card-img-top rounded-top-4"
            alt="{{ product.product_name }}"
          /> -->
          <div class="card-body text-center">
            <h5 class="fw-bold">{{ product.product_name }}</h5>

            @if (product.offer_price) {
              <p>
                <span class="text-muted text-decoration-line-through me-2">
                  â‚¹{{ product.price }}
                </span>
                <span class="text-success fw-bold">â‚¹{{ product.offer_price }}</span>
              </p>
            } @else {
              <p class="text-dark fw-bold">â‚¹{{ product.price }}</p>
            }

            <div class="d-flex justify-content-center gap-2 mt-2">
              <button
                class="btn btn-outline-info btn-sm rounded-pill"
                (click)="openDetails(product)"
              >
                <i class="fa fa-info-circle me-1"></i> Details
              </button>

             
            </div>
          </div>
        </div>

            }
      </div>
    }
  </div>
</div>

<!-- ðŸ”¹ Product Details Modal -->
@if (showDetails) {
  <div class="custom-modal">
    <div class="custom-modal-content rounded-4">
      <div class="modal-header bg-info text-white rounded-top-4">
        <h5 class="modal-title fw-bold">{{ selectedProduct?.product_name }}</h5>
        <button class="btn-close btn-close-white" (click)="closeDetails()"></button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-md-6 text-center">
            <h1>{{selectedProduct?.product_name}}</h1>
            @if(selectedProduct?.stock=="Available"){
                <span><p class="text-success">{{selectedProduct?.stock}}</p></span>
            }@else{
                 <span><p class="text-danger">{{selectedProduct?.stock}}</p></span>

            }
            <!-- <img
              [src]="selectedProduct?.image"
              alt="Product"
              class="img-fluid rounded mb-3"
            /> -->
          </div>
          <div class="col-md-6">
            <p class="text-primary">{{ selectedProduct?.product_description }}</p>
            <h6 class="text-primary">
              @if (selectedProduct?.offer_price) {
               <span class="text-muted"> Prices :</span>
                
                â‚¹{{ selectedProduct?.offer_price }}
              } @else {
                â‚¹{{ selectedProduct?.price }}
              }
            </h6>
          </div>
        </div>
      </div>
    </div>
  </div>
}

<!-- ðŸ”¹ Order Form Modal -->
@if (showOrderForm) {
 <div class="custom-modal">
  <div class="custom-modal-content rounded-4">
    <div class="modal-header bg-primary text-white rounded-top-4">
      <h5 class="modal-title">Place New Order</h5>
      <button class="btn-close btn-close-white" (click)="closeOrderForm()"></button>
    </div>

    <div class="modal-body">
      <form [formGroup]="orderForm" (ngSubmit)="placeOrder()">
       

        <div class="mb-3">
          <label class="form-label">Product Name</label>
          <input
            type="text"
            class="form-control"
            formControlName="productName"
            readonly
          />
        </div>

        <div class="mb-3">
          <label class="form-label">Customer Name</label>
          <input
            type="text"
            class="form-control"
            formControlName="customerName"
            placeholder="Enter customer name"
            readonly
          />
        </div>

        <div class="mb-3">
          <label class="form-label">Quantity</label>
          <input
            type="number"
            class="form-control"
            formControlName="quantity"
            min="1"
            placeholder="Enter quantity"
          />
        </div>

        <div class="mb-3">
          <label class="form-label">Address</label>
          <textarea
            class="form-control"
            formControlName="address"
            rows="2"
            placeholder="Enter delivery address"
          ></textarea>
        </div>

        <div class="mb-3">
          <label class="form-label">Total Price</label>
          <input
            type="number"
            class="form-control"
            formControlName="totalPrice"
            placeholder="Enter total price"
          />
        </div>

        <div class="mb-3">
          <label class="form-label">Payment Method</label>
          <select class="form-select" formControlName="paymentMethod">
            <option value="">Select Payment Method</option>
            <option value="Cash on Delivery">Cash on Delivery</option>
            <option value="Credit Card">Credit Card</option>
            <option value="Debit Card">Debit Card</option>
            <option value="UPI">UPI</option>
            <option value="Net Banking">Net Banking</option>
          </select>
        </div>

        <div class="text-center">
          <button type="submit" class="btn btn-success rounded-pill px-4">
            Confirm Order
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

}
